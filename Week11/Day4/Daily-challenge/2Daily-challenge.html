<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2nd Daily challenge</title>
</head>
<body>
    <form id="form" method="get">
    <label for="text">Please type a word or sentence for translation into Morse code:</label> <br>
    <textarea name="text" id="text" cols="30" rows="15"></textarea> <br>
    <input type="button" value="Translate" id="translate">
    </form>
    <hr>
<div id="outcome">

</div>


    <script>
        const morse = `{
  "0": "-----",
  "1": ".----",
  "2": "..---",
  "3": "...--",
  "4": "....-",
  "5": ".....",
  "6": "-....",
  "7": "--...",
  "8": "---..",
  "9": "----.",
  "a": ".-",
  "b": "-...",
  "c": "-.-.",
  "d": "-..",
  "e": ".",
  "f": "..-.",
  "g": "--.",
  "h": "....",
  "i": "..",
  "j": ".---",
  "k": "-.-",
  "l": ".-..",
  "m": "--",
  "n": "-.",
  "o": "---",
  "p": ".--.",
  "q": "--.-",
  "r": ".-.",
  "s": "...",
  "t": "-",
  "u": "..-",
  "v": "...-",
  "w": ".--",
  "x": "-..-",
  "y": "-.--",
  "z": "--..",
  ".": ".-.-.-",
  ",": "--..--",
  "?": "..--..",
  "!": "-.-.--",
  "-": "-....-",
  "/": "-..-.",
  "@": ".--.-.",
  "(": "-.--.",
  ")": "-.--.-"
}` ;

/* Create three functions. The two first functions should return a promise..

The first function is named toJs():
this function converts the morse json string provided above to a morse javascript object.
if the morse javascript object is empty, throw an error (use reject)
else return the morse javascript object (use resolve) */

const toJs = (jsString) => new Promise ((resolve, reject) => {
    try {
        const jsObject = JSON.parse(jsString);
        if (Object.keys(jsObject).length === 0) {
           reject('Error: JSON object is empty');
        } else {
           resolve(jsObject);
        }

    } catch (error) {
        reject(`Error: invalid JSON - ${error.message}`);
    }
    
})

/*
The second function called toMorse(morseJS), takes one argument: the new morse javascript object.

This function asks the user for a word or a sentence.
if the user entered a character that doesn’t exist in the new morse javascript object, throw an error. (use reject)
else return an array with the morse translation of the user’s word.
if the user enters the word "Hello", the promise resolves with this value ["....", ".", ".-..", ".-..","---"]
if the user entered the word "¡Hola!", the promise rejects because the character "¡" doesn't exist in the morse javascript object
*/


const toMorse = (morseJS) => {
  const text = document.getElementById('text').value;  
  return new Promise((resolve, reject) => {
    const userSentence = text;
    const arrayUserSentence = userSentence.toLowerCase().split('');

    // checking char in json object
    const isValid = arrayUserSentence.every(char => morseJS.hasOwnProperty(char));

    if (!isValid) {
      reject(new Error('Your input contains characters that cannot be translated to Morse code.'));
    } else {
      const morseTranslation = arrayUserSentence.map(char => morseJS[char]);
      resolve(morseTranslation);
    }
  });
};

/* The third function called joinWords(morseTranslation), takes one argument: the morse translation array

this function joins the morse translation by using line break and display it on the page (ie. On the DOM) */



const joinWords = (morseTranslation) => {
    const morseOutput = morseTranslation.join('<br>');
    const outcome = document.getElementById('outcome')
    outcome.innerHTML =morseOutput;
}

/*Chain the three functions. */
document.getElementById('translate').addEventListener('click',  () => {
toJs(morse)
  .then(morseJS => toMorse(morseJS))
  .then(morseTranslation => joinWords(morseTranslation))
  .catch(error => alert('Error: ' +(error.message || error)));

})



    </script>
</body>
</html>